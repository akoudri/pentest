import nmap

# Initialiser un scanner nmap
nm = nmap.PortScanner()

# Spécifier la cible
target = '192.168.221.16'

# Effectuer un scan SYN sur les ports communs
nm.scan(target, arguments='-sS -O -p 22-1024')

# Afficher les informations sur l'hôte
print(f"Host : {target}")
print(f"State : {nm[target].state()}")

# Afficher les ports ouverts et les services associés
for proto in nm[target].all_protocols():
    print(f"Protocol : {proto}")
    ports = nm[target][proto].keys()

    for port in ports:
        print(f"port : {port}\tstate : {nm[target][proto][port]['state']}\tservice : {nm[target][proto][port]['name']}")