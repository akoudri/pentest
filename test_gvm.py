from gvm.connections import UnixSocketConnection
from gvm.protocols.gmp import Gmp

# Établir une connexion à OpenVAS
connection = UnixSocketConnection()
gmp = Gmp(connection=connection)

# Authentification
gmp.authenticate('username', 'password')

# Créer une nouvelle tâche de scan
task_id = gmp.create_task('Mon scan', config_id='daba56c8-73ec-11df-a475-002264764cea', target_id='b493b7a8-7489-11df-a3ec-002264764cea')

# Lancer le scan
gmp.start_task(task_id)

# Attendre la fin du scan et récupérer les résultats
report_id = gmp.get_task(task_id).find('last_report').attrib['id']
report = gmp.get_report(report_id)

# Traiter les résultats du scan
# ...