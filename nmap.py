import nmap

# Create an Nmap scanner object
scanner = nmap.PortScanner()

# Specify the target host and scan options
target_host = "192.168.1.1"
scan_options = "-sV -p-"

# Perform the scan
scanner.scan(hosts=target_host, arguments=scan_options)

# Print the scan results
for host in scanner.all_hosts():
    print("Host:", host)
    print("State:", scanner[host].state())
    for proto in scanner[host].all_protocols():
        print("Protocol:", proto)
        ports = scanner[host][proto].keys()
        for port in ports:
            print("Port:", port, "State:", scanner[host][proto][port]['state'])