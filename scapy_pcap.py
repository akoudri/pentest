from scapy.all import *

# Charger le fichier PCAP
packets = rdpcap('wireshark/geoip.pcap')

# Afficher un résumé des paquets
print("Résumé des paquets :")
packets.summary()

# Parcourir et analyser chaque paquet
print("\nAnalyse détaillée des 5 premiers paquets :")
for packet in packets[:5]:
    print(f"Paquet #{packet.name}")

    # Afficher les couches du paquet
    print("Couches :", packet.layers())

    # Accéder aux champs spécifiques du paquet
    if 'IP' in packet:
        print("Source IP:", packet['IP'].src)
        print("Destination IP:", packet['IP'].dst)

    if 'TCP' in packet:
        print("Source Port:", packet['TCP'].sport)
        print("Destination Port:", packet['TCP'].dport)

    if 'UDP' in packet:
        print("Source Port:", packet['UDP'].sport)
        print("Destination Port:", packet['UDP'].dport)

    if 'HTTP' in packet:
        print("Requête HTTP:")
        print(packet['HTTP'].show())

    # Ajouter d'autres analyses spécifiques selon vos besoins

    print("------------------------")